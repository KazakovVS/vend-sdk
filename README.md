# Vend SDK (a PHP client)
[![Latest Version](https://img.shields.io/github/release/simplesquid/vend-sdk.svg?style=flat-square)](https://github.com/simplesquid/vend-sdk/releases)
[![MIT Licensed](https://img.shields.io/badge/license-MIT-brightgreen.svg?style=flat-square)](LICENSE)
[![Total Downloads](https://img.shields.io/packagist/dt/simplesquid/vend-sdk.svg?style=flat-square)](https://packagist.org/packages/simplesquid/vend-sdk)

An unofficial PHP SDK for Vend POS | https://docs.vendhq.com/

Contributions, issues and suggestions are very much welcome.

## Installation

To install the SDK in your project you need to require the package via composer:

```bash
composer require simplesquid/vend-sdk
```

Then use Composer's autoload:

```php
require __DIR__.'/../vendor/autoload.php';
```

And finally get the instance of the SDK, and set the desired user agent:

```php
$vend = Vend::getInstance();

/* Optional configuration. */
$vend->userAgent('Vend SDK')
     ->requestTimeout(2)
     ->confirmationTimeout(30);
```

It is advisable that you use the client object as a singleton, however, there is no explicit restriction for this.

## How to use

This outlines a typical sequence of instructions, but is not a complete list of all the functionality of the SDK. Please review the code for more advanced usages. It is also suggested you read the Vend API documentation found here: https://docs.vendhq.com/

Alternatively, you can see a working authorisation implementation in our [Laravel Vend SDK package](https://github.com/simplesquid/laravel-vend-sdk).

### Authorisation

You have two options for authorisation with the Vend API, a Personal Access Token or OAuth 2.0.

#### Personal Access Token

When using the Personal Access Token, simply setup the Vend client like so:

```php
$vend->domainPrefix($domain_prefix)
     ->personalAccessToken($access_token);
```

#### OAuth 2.0

Setup the Vend client with the OAuth identifiers:

```php
$vend->clientId($client_id)
     ->clientSecret($client_secret)
     ->redirectUri($redirect);
```

##### Initial authorisation procedure

Send the user to the OAuth URL generated by:

```php
$vend->getAuthorisationUrl($previous_url);
```

Use the domain prefix and authorisation code returned from the OAuth process:

```php
/** @var \SimpleSquid\Vend\Resources\OneDotZero\Token */
$token = $vend->domainPrefix($domain_prefix)
              ->oAuthAuthorisationCode($code);
```

Make sure you store the returned Token object and the domain prefix.

##### Subsequent setup procedure

Once you have received the initial authorisation, you may setup the Vend client using the Token object received during the authorisation process:

```php
$vend->authorisationToken($token);
```

If a request throws a `\SimpleSquid\Vend\Exceptions\TokenExpiredException`, you can refresh the token like so:

```php
/** @var \SimpleSquid\Vend\Resources\OneDotZero\Token */
$token = $vend->refreshOAuthAuthorisationToken();
```

Again, make sure you store the returned Token object.

### Requests

To see all the available requests, take a look at traits located in the `Actions` folder. As an example, Products can be managed using the following requests:

```php
/**
 * List products.
 * Returns a paginated list of products.
 *
 * @param  int|null   $page_size  The maximum number of items to be returned in the response.
 * @param  int|null   $after      The lower limit for the version numbers to be included in the response.
 * @param  int|null   $before     The upper limit for the version numbers to be included in the response.
 * @param  bool|null  $deleted    Indicates whether deleted items should be included in the response.
 *
 * @return \SimpleSquid\Vend\Resources\TwoDotZero\ProductCollection
 */
$products = $vend->product->get($page_size, $after, $before, $deleted);
```

```php
/**
 * Get a single product.
 * Returns a single product object with a given ID.
 *
 * @param  string  $id  Valid product ID.
 *
 * @return \SimpleSquid\Vend\Resources\TwoDotZero\Product
 */
$product = $vend->product->find($id);
```

_More examples to come..._